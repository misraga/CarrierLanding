
       run F18data.m
       r2d = 180/pi;
       d2r = pi/180;
       k2fps = 1.68781;
       alt = 500;              % ft, altitude 
 
    
  x0 = [225;0.17543;0;0;0;0;0;0.11448;0];
  u0 = [-11.86;0;0;0.29*11200];
  % u0 =   [0; 0;0;8.1;10.8453;2.4;-10;7100.6136] 
xe = 0;
ye = 0;
ze = -800;
[xtrim, utrim, dx] = F18trim_sim(x0,u0);

dxtrim = xtrim
 tspan = [0 10];
    [t,y_s ] = ode45(@(t,y) aircraft_EOM(t, y, utrim), tspan,dxtrim);
    [t,y_a]  = ode45(@(t,y) aircraft_EOM2(t,y,utrim), tspan,[xtrim;xe;ye;ze]);
   
 [A,B,C,D]=linmod('f18trim',xtrim,utrim);
 disp(eig(A));
%  x = xtrim;
% for i = 1:121
%     
%     x = A*x+B*utrim;
%     
% end
% xtrim = [275.431077993822;0.0935511250378405;8.57841938827557e-25;-8.57671977408811e-25;-5.61532055310605e-24;3.04121936491915e-25;-7.89236155168787e-25;0.155883474141422;-7.77962672732373e-17];
% utrim = [-0.272663127747623;8.04708707331107;31.1443471293588;8.04045513221147;10.8453085376162;2.40384615384615;-21.6148034657650;7100.61358629918];